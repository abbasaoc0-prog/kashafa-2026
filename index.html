<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙƒØ´Ø§ÙØ© Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ | Ø°ÙŠ Ù‚Ø§Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore-compat.js"></script>
    <style>
        :root { --gold: #d4af37; --azure: #001f3f; --off-white: #fdfdfb; --correct: #2ecc71; --wrong: #e74c3c; }
        body { background: var(--off-white); font-family: 'Cairo', sans-serif; margin:0; overflow-x: hidden; }
        
        /* Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #gate-keeper { position: fixed; inset: 0; z-index: 99999; background: radial-gradient(circle, #002244 0%, #000000 100%); display: flex; justify-content: center; align-items: center; transition: 1.5s all ease-in-out; }
        .fade-exit { opacity: 0 !important; visibility: hidden; filter: blur(30px); transform: scale(1.1); }
        .name-tag { position: absolute; color: var(--gold); font-family: 'Amiri', serif; font-size: 1.2rem; font-weight: 900; text-shadow: 0 0 10px gold; white-space: nowrap; }

        /* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª */
        .full-page { 
            position: fixed; inset: 0; background: var(--off-white); z-index: 500; 
            display: none; flex-direction: column; overflow-y: auto; padding: 20px;
            animation: slideUp 0.4s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(50%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .gold-title { color: var(--gold) !important; font-family: 'Amiri', serif; font-weight: 900; }
        .btn-exit-mini { background: #c0392b; color: white; padding: 5px 15px; border-radius: 8px; font-size: 0.8rem; font-weight: 900; }

        /* ØªØµØºÙŠØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 600px) {
            header { py: 5 !important; }
            header h1 { font-size: 1.4rem !important; line-height: 1.4; }
            header h2 { font-size: 1.1rem !important; }
            .nav-square { border-radius: 25px !important; }
            .nav-square span { font-size: 3.5rem !important; margin-bottom: 5px !important; }
            .nav-square h3 { font-size: 1.1rem !important; }
            .grid { gap: 15px !important; padding: 15px !important; }
            .bismillah-btn-special { font-size: 1.8rem !important; padding: 10px 40px !important; }
        }

        .bismillah-btn-special {
            background: linear-gradient(145deg, #d4af37, #b8860b);
            color: white; padding: 15px 60px; border-radius: 50px;
            font-size: 2.5rem; font-family: 'Amiri', serif; font-weight: 900;
            border: 4px solid #fff; box-shadow: 0 10px 25px rgba(212,175,55,0.4);
            cursor: pointer;
        }

        .opt-btn { width: 100%; padding: 15px; border: 2px solid var(--gold); border-radius: 12px; font-weight: 900; background: white; margin-bottom: 8px; font-size: 1.1rem; }
        .opt-correct { background: var(--correct) !important; color: white !important; }
        .opt-wrong { background: var(--wrong) !important; color: white !important; }

        /* Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ù…Ø¹Ø¯Ù„Ø© */
        #cert-box { 
            background: white; border: 12px double var(--gold); padding: 30px 15px; 
            text-align: center; position: relative; width: 100%; max-width: 450px; margin: auto;
            display: none;
        }
        #cert-box h3#cert-name { font-family: 'Amiri', serif; color: var(--gold); font-size: 2.5rem; margin: 10px 0; font-weight: 900; }

        .nav-square { aspect-ratio: 1/1; background: white; border: 4px solid var(--gold); border-radius: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
    </style>
</head>
<body>

    <div id="gate-keeper">
        <div class="relative w-[300px] h-[300px] md:w-[600px] md:h-[600px] flex justify-center items-center">
            <div id="names-ring"></div>
            <div class="absolute w-40 h-40 md:w-56 md:h-56 rounded-full bg-white border-8 border-gold overflow-hidden cursor-pointer z-20" onclick="enterSite()">
                <div class="h-full flex flex-col">
                    <div class="flex-1 bg-[#ce1126]"></div>
                    <div class="flex-1 flex items-center justify-center text-[#007a3d] font-black text-xl md:text-2xl font-['Amiri']">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</div>
                    <div class="flex-1 bg-black"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="main-ui" class="hidden">
        <header class="py-6 text-center bg-white border-b-4 border-gold">
            <h1 class="gold-title text-2xl md:text-5xl mb-1">Ù…ÙƒØªØ¨ Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ø´Ù‡ÙŠØ¯ Ù…Ø­Ù…Ø¯ Ø§Ù„ØµØ¯Ø± (Ù‚Ø¯Ø³ Ø³Ø±Ù‡)</h1>
            <h2 class="gold-title text-xl md:text-3xl">ÙƒØ´Ø§ÙØ© Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ | Ø°ÙŠ Ù‚Ø§Ø±</h2>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6 max-w-6xl mx-auto">
            <div class="nav-square" onclick="showSection('gallery-page')"><span class="text-6xl mb-2">ğŸ–¼ï¸</span><h3 class="text-xl font-black">Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ´ÙÙŠ</h3></div>
            <div class="nav-square" onclick="showSection('quotes-page')"><span class="text-6xl mb-2">ğŸ“œ</span><h3 class="text-xl font-black">Ø£Ù‚ÙˆØ§Ù„ Ø§Ù„Ø¥Ù…Ø§Ù… Ø¹Ù„ÙŠ (Ø¹)</h3></div>
            <div class="nav-square" onclick="showSection('quiz-page')"><span class="text-6xl mb-2">ğŸ“</span><h3 class="text-xl font-black">Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒØ¹Ø¨Ø©</h3></div>
        </div>

        <div class="text-center py-10 px-4 border-t-2 border-gold mt-6 bg-white">
            <h3 class="gold-title text-2xl font-black italic">Ù†Ø¨Ø§Ø±Ùƒ Ù„ÙƒÙ… ÙˆÙ„Ø§Ø¯Ø© Ø£Ù…ÙŠØ± Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ† (Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…)</h3>
        </div>
    </div>

    <div id="quiz-page" class="full-page">
        <div class="text-right mb-4"><button onclick="hideSection('quiz-page')" class="btn-exit-mini">âœ– Ø§Ù†Ø³Ø­Ø§Ø¨</button></div>
        <div id="quiz-init" class="text-center">
            <h2 class="gold-title text-3xl mb-6">Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒØ¹Ø¨Ø©</h2>
            <div class="max-w-md mx-auto bg-white p-8 rounded-[30px] border-4 border-gold shadow-xl">
                <input type="text" id="p-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù„Ù‚Ø¨" class="w-full p-3 border-2 border-gold rounded-xl mb-8 text-center text-lg font-black outline-none">
                <button onclick="startChallenge()" class="bismillah-btn-special">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡</button>
            </div>
        </div>

        <div id="quiz-main" class="hidden max-w-xl mx-auto bg-white p-6 rounded-2xl border-4 border-gold text-center shadow-xl">
            <div class="q-counter">Ø³Ø¤Ø§Ù„ <span id="q-num">1</span> Ù…Ù† <span id="q-total">0</span></div>
            <h3 id="q-display" class="text-2xl font-black mb-8 text-azure"></h3>
            <div id="opts-display"></div>
        </div>

        <div id="cert-box">
            <h2 style="font-family: 'Amiri', serif; color: #8b6b23; font-size: 1.4rem; margin-bottom: 5px;">Ù…ÙƒØªØ¨ Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ø´Ù‡ÙŠØ¯ Ø§Ù„ØµØ¯Ø± (Ù‚Ø¯Ø³ Ø³Ø±Ù‡)</h2>
            <p style="font-size: 0.9rem; margin-bottom: 10px; border-bottom: 1px dashed #D4AF37; padding-bottom: 5px;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙƒØ´ÙÙŠ | Ø°ÙŠ Ù‚Ø§Ø±</p>
            <p style="font-size: 1rem;">ØªØªÙ‚Ø¯Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ´Ø§ÙØ© Ø¨Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ù„Ù„ÙƒØ´Ø§Ù Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ:</p>
            <h3 id="cert-name"></h3>
            <p style="font-size: 1rem; line-height: 1.5;">Ù„Ø§Ø¬ØªÙŠØ§Ø²Ù‡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙƒØ´ÙÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¨Ø¯Ø±Ø¬Ø© ÙƒØ§Ù…Ù„Ø©ØŒ Ù…ØªÙ…Ù†ÙŠÙ† Ù„Ù‡ Ø¯ÙˆØ§Ù… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø°Ù‡Ø¨ ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹.</p>
            <div style="margin-top: 20px; display: flex; justify-content: space-around; font-weight: bold; font-size: 0.9rem; color: #444;">
                <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ´Ø§ÙØ©</span>
                <span>Ø®ØªÙ… Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</span>
            </div>
            <button onclick="location.reload()" class="mt-6 text-gray-400 text-xs underline">Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <div id="gallery-page" class="full-page">
        <div class="flex justify-between mb-4">
            <button onclick="hideSection('gallery-page')" class="btn-exit-mini" style="background:var(--gold)">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
            <button onclick="adminLogin()" class="text-gray-300 text-[10px]">ADMIN</button>
        </div>
        <div id="admin-panel" class="hidden bg-yellow-50 p-4 rounded-xl border-2 border-dashed border-gold mb-6">
            <input type="text" id="q-in" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„" class="w-full p-2 mb-2 border rounded">
            <div class="grid grid-cols-3 gap-1 mb-2">
                <input type="text" id="o1" placeholder="Ø®ÙŠØ§Ø±1" class="p-2 border rounded">
                <input type="text" id="o2" placeholder="Ø®ÙŠØ§Ø±2" class="p-2 border rounded">
                <input type="text" id="o3" placeholder="Ø®ÙŠØ§Ø±3" class="p-2 border rounded">
            </div>
            <select id="c-in" class="w-full p-2 mb-2 border rounded"><option value="0">1</option><option value="1">2</option><option value="2">3</option></select>
            <button onclick="addQ()" class="w-full bg-blue-600 text-white p-2 rounded">Ù†Ø´Ø±</button>
            <div id="admin-q-list" class="mt-4 max-h-40 overflow-y-auto"></div>
        </div>
        <div id="gal-grid" class="columns-2 gap-2 px-1"></div>
    </div>

    <div id="quotes-page" class="full-page">
        <button onclick="hideSection('quotes-page')" class="btn-exit-mini mb-6 w-24" style="background:var(--gold)">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <div id="quotes-list" class="space-y-3"></div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyCajxAScOpEbQShZ-8JNcqmrf6gFz8ncnE", authDomain: "mall-bet-madmoom.firebaseapp.com", projectId: "mall-bet-madmoom", appId: "1:922712350704:web:9751ad2419f915a9a74735" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function enterSite() { 
            document.getElementById('gate-keeper').classList.add('fade-exit'); 
            setTimeout(() => { 
                document.getElementById('gate-keeper').style.display='none'; 
                document.getElementById('main-ui').classList.remove('hidden'); 
                loadGal(); loadQuotes(); fetchQs(); 
            }, 1200); 
        }

        const names = ["Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…ØµØ·ÙÙ‰", "Ø¹Ù„ÙŠ Ø§Ù„Ù…Ø±ØªØ¶Ù‰", "ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡", "Ø§Ù„Ø­Ø³Ù† Ø§Ù„Ù…Ø¬ØªØ¨Ù‰", "Ø§Ù„Ø­Ø³ÙŠÙ† Ø§Ù„Ø´Ù‡ÙŠØ¯", "Ø¹Ù„ÙŠ Ø§Ù„Ø³Ø¬Ø§Ø¯", "Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø§Ù‚Ø±", "Ø¬Ø¹ÙØ± Ø§Ù„ØµØ§Ø¯Ù‚", "Ù…ÙˆØ³Ù‰ Ø§Ù„ÙƒØ§Ø¸Ù…", "Ø¹Ù„ÙŠ Ø§Ù„Ø±Ø¶Ø§", "Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¬ÙˆØ§Ø¯", "Ø¹Ù„ÙŠ Ø§Ù„Ù‡Ø§Ø¯ÙŠ", "Ø§Ù„Ø­Ø³Ù† Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ", "Ø§Ù„Ù…Ù‡Ø¯ÙŠ Ø§Ù„Ù…Ù†ØªØ¸Ø±"];
        const ring = document.getElementById('names-ring');
        names.forEach((n, i) => {
            const angle = (i * 360 / 14) * (Math.PI / 180) - (Math.PI / 2);
            const tag = document.createElement('div'); tag.className = 'name-tag';
            const radius = window.innerWidth < 600 ? 140 : 230;
            tag.style.left = `calc(50% + ${Math.cos(angle)*radius}px)`; tag.style.top = `calc(50% + ${Math.sin(angle)*radius}px)`;
            tag.style.transform = 'translate(-50%, -50%)'; tag.innerText = n; ring.appendChild(tag);
        });

        let questions = [], cur = 0, score = 0, rawN = "";
        async function fetchQs() { const snap = await db.collection("final_v9").orderBy("date").get(); questions = snap.docs.map(doc => doc.data()); }

        function startChallenge() {
            rawN = document.getElementById('p-name').value;
            if(rawN.trim().split(" ").length < 3) return alert("Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù„Ù‚Ø¨!");
            document.getElementById('quiz-init').classList.add('hidden'); 
            document.getElementById('quiz-main').classList.remove('hidden');
            showQ();
        }

        function showQ() {
            const q = questions[cur];
            document.getElementById('q-num').innerText = cur + 1;
            document.getElementById('q-total').innerText = questions.length;
            document.getElementById('q-display').innerText = q.q;
            const b = document.getElementById('opts-display'); b.innerHTML = "";
            q.options.forEach((o, i) => {
                const btn = document.createElement('button'); btn.className = "opt-btn"; btn.innerText = o;
                btn.onclick = () => {
                    const all = b.querySelectorAll('button');
                    if(i === q.correct) { btn.classList.add('opt-correct'); score++; }
                    else { btn.classList.add('opt-wrong'); all[q.correct].classList.add('opt-correct'); }
                    all.forEach(bt => bt.disabled = true);
                    setTimeout(() => { cur++; if(cur < questions.length) showQ(); else finish(); }, 1000);
                };
                b.appendChild(btn);
            });
        }

        function finish() {
            document.getElementById('quiz-main').classList.add('hidden');
            const parts = rawN.trim().split(/\s+/);
            const dispName = parts[0] + " " + parts[parts.length - 1]; // Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨
            document.getElementById('cert-name').innerText = dispName;
            document.getElementById('cert-box').style.display = 'block';
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØ²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹
        function showSection(id) { 
            document.getElementById(id).style.display = 'flex'; 
            history.pushState({ section: id }, "");
        }
        function hideSection(id) { 
            document.getElementById(id).style.display = 'none'; 
        }

        window.onpopstate = function(event) {
            const allPages = document.querySelectorAll('.full-page');
            allPages.forEach(p => p.style.display = 'none');
        };

        function adminLogin() { if(prompt("Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === "asd.alrahe2001") { document.getElementById('admin-panel').classList.toggle('hidden'); renderAList(); } }
        async function addQ() {
            const q = document.getElementById('q-in').value, opts = [document.getElementById('o1').value, document.getElementById('o2').value, document.getElementById('o3').value], correct = parseInt(document.getElementById('c-in').value);
            if(q && opts[2]) { await db.collection("final_v9").add({ q, options: opts, correct, date: new Date() }); renderAList(); fetchQs(); alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±"); }
        }
        async function renderAList() {
            const snap = await db.collection("final_v9").orderBy("date").get();
            const l = document.getElementById('admin-q-list'); l.innerHTML = "";
            snap.forEach(doc => l.innerHTML += `<div class='flex justify-between p-2 border-b text-xs'><span>${doc.data().q}</span><button onclick="delQ('${doc.id}')" class='text-red-500'>Ø­Ø°Ù</button></div>`);
        }
        async function delQ(id) { await db.collection("final_v9").doc(id).delete(); renderAList(); }

        function loadQuotes() {
            const hq = ["Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù ØµÙÙ†Ù’ÙÙØ§Ù†Ù: Ø¥ÙÙ…ÙÙ‘Ø§ Ø£ÙØ®ÙŒ Ù„ÙÙƒÙ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†ÙØŒ Ø£ÙÙˆÙ’ Ù†ÙØ¸ÙÙŠØ±ÙŒ Ù„ÙÙƒÙ ÙÙÙŠ Ø§Ù„Ù’Ø®ÙÙ„Ù’Ù‚Ù.","Ù…ÙØ§ Ø¶ÙØ§Ø¹Ù Ø§Ù…Ù’Ø±ÙØ¤ÙŒ Ø¹ÙØ±ÙÙÙ Ù‚ÙØ¯Ù’Ø±ÙÙ‡Ù.","Ø§Ù„Ù’Ø¹ÙÙ„Ù’Ù…Ù Ù†ÙÙ‡Ù’Ø±ÙŒØŒ ÙˆÙØ§Ù„Ù’Ø­ÙÙƒÙ’Ù…ÙØ©Ù Ø¨ÙØ­Ù’Ø±ÙŒ.","Ø£ÙÙƒÙ’Ø±ÙÙ…Ù’ Ø¶ÙÙŠÙ’ÙÙÙƒÙ ÙˆÙØ¥ÙÙ†Ù’ ÙƒÙØ§Ù†Ù Ø­ÙÙ‚ÙÙŠØ±Ø§Ù‹.","Ù‚ÙÙŠÙ…ÙØ©Ù ÙƒÙÙ„ÙÙ‘ Ø§Ù…Ù’Ø±ÙØ¦Ù Ù…ÙØ§ ÙŠÙØ­Ù’Ø³ÙÙ†ÙÙ‡Ù.","Ø§Ù„Ù’Ø¹ÙÙ„Ù’Ù…Ù Ø®ÙÙŠÙ’Ø±ÙŒ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ§Ù„Ù.","Ù„Ø§ ØºÙÙ†ÙÙ‰ ÙƒÙØ§Ù„Ù’Ø¹ÙÙ‚Ù’Ù„ÙØŒ ÙˆÙÙ„Ø§ ÙÙÙ‚Ù’Ø±Ù ÙƒÙØ§Ù„Ù’Ø¬ÙÙ‡Ù’Ù„Ù.","Ø¥ÙØ°ÙØ§ ØªÙÙ…ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙ‚Ù’Ù„Ù Ù†ÙÙ‚ÙØµÙ Ø§Ù„Ù’ÙƒÙÙ„Ø§Ù…Ù."];
            document.getElementById('quotes-list').innerHTML = hq.map(q => `<div class="p-4 bg-white border-r-4 border-gold shadow-sm text-lg font-['Amiri']">${q}</div>`).join('');
        }
        function loadGal() { const g = document.getElementById('gal-grid'); for(let i=1; i<=20; i++) g.innerHTML += `<img src="gallery/${i}.jpg" onerror="this.style.display='none'" class="w-full rounded-xl mb-2 border border-gold shadow-sm">`; }
    </script>
</body>
</html>
