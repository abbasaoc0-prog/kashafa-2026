<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙƒØ´Ø§ÙØ© Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ | </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore-compat.js"></script>
    <style>
        :root { --gold: #d4af37; --azure: #001f3f; --off-white: #fdfdfb; --correct: #2ecc71; --wrong: #e74c3c; }
        body { background: var(--off-white); font-family: 'Cairo', sans-serif; margin:0; overflow-x: hidden; }
        
        /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© - Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙŠØ§Ø®Ø© Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© */
        #gate-keeper { position: fixed; inset: 0; z-index: 99999; background: #000; display: flex; justify-content: center; align-items: center; perspective: 1200px; }
        .shirt-base { position: relative; width: 100%; max-width: 450px; height: 100vh; background: #fff; background-image: radial-gradient(#efefef 1px, transparent 1px); background-size: 10px 10px; transition: 1.5s all cubic-bezier(0.7, 0, 0.3, 1); }
        
        .collar-box { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 340px; height: 120px; z-index: 45; }
        .collar-left { position: absolute; left: 0; width: 170px; height: 110px; background: #111; clip-path: polygon(0 0, 100% 0, 85% 100%, 0 85%); border-bottom: 4px solid var(--gold); }
        .collar-right { position: absolute; right: 0; width: 170px; height: 110px; background: #111; clip-path: polygon(0 0, 100% 0, 100% 85%, 15% 100%); border-bottom: 4px solid var(--gold); }
        
        .scarf { position: absolute; top: 60px; left: 50%; transform: translateX(-50%); width: 110px; height: 420px; z-index: 30; cursor: pointer; background: linear-gradient(90deg, #000 42%, var(--gold) 42%, var(--gold) 58%, #000 58%); clip-path: polygon(50% 0, 100% 18%, 82% 100%, 50% 92%, 18% 100%, 0 18%); filter: drop-shadow(0 20px 20px rgba(0,0,0,0.5)); }
        .evaporate { filter: blur(20px) brightness(3); transform: scale(3) rotate(5deg); opacity: 0; }
        
        .full-page { position: fixed; inset: 0; background: var(--off-white); z-index: 500; display: none; flex-direction: column; overflow-y: auto; padding: 20px; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { transform: translateY(30%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .nav-square { aspect-ratio: 1/1; background: white; border: 4px solid var(--gold); border-radius: 30px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; }
        #cert-box { background: white; border: 12px double var(--gold); padding: 30px 15px; text-align: center; position: relative; width: 100%; max-width: 450px; margin: auto; display: none; }
    </style>
</head>
<body>

    <div id="gate-keeper">
        <div id="scout-shirt" class="shirt-base">
            <div class="collar-box">
                <div class="collar-left"></div>
                <div class="collar-right"></div>
            </div>
            <div class="scarf" onclick="triggerWarp()">
                <div style="position:absolute; top:105px; left:50%; transform:translateX(-50%); width:55px; height:45px; background:linear-gradient(145deg, #ffd700, #8b6b23); border-radius:6px; display:flex; align-items:center; justify-content:center; box-shadow: 0 5px 10px rgba(0,0,0,0.4);">
                    <span style="font-size:22px;">âšœï¸</span>
                </div>
            </div>
            <div style="position:absolute; top:260px; right:20px; width:100px; height:42px; background:#000; border:2px solid var(--gold); display:flex; align-items:center; justify-content:center; border-radius:3px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
                <span style="color:var(--gold); font-size:0.6rem; font-weight:900; text-align:center;">ÙƒØ´Ø§ÙØ©<br>Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ</span>
            </div>
            <div style="position:absolute; top:260px; left:20px; width:100px; height:42px; border:1px solid #ccc; display:flex; flex-direction:column; overflow:hidden; border-radius:3px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <div style="flex:1; background:#ff0000;"></div><div style="flex:1; background:#ffffff; display:flex; align-items:center; justify-content:center; font-size:8px; color:#007a3d; font-weight:bold;">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</div><div style="flex:1; background:#000000;"></div>
            </div>
        </div>
    </div>

    <div id="main-ui" class="hidden">
        <header class="py-6 text-center bg-white border-b-4 border-gold">
            <h1 class="text-gold text-2xl md:text-4xl mb-1 font-['Amiri'] font-black">Ù…ÙƒØªØ¨ Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ø´Ù‡ÙŠØ¯ Ù…Ø­Ù…Ø¯ Ø§Ù„ØµØ¯Ø± (Ù‚Ø¯Ø³ Ø³Ø±Ù‡)</h1>
            <h2 class="text-gold text-xl font-['Amiri']">ÙƒØ´Ø§ÙØ© Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ | Ø°ÙŠ Ù‚Ø§Ø±</h2>
        </header>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 max-w-6xl mx-auto mt-6">
            <div class="nav-square" onclick="showSection('quiz-page')"><span class="text-4xl mb-2">ğŸ“</span><h3 class="text-sm font-black">Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒØ¹Ø¨Ø©</h3></div>
            <div class="nav-square" onclick="showSection('gallery-page')"><span class="text-4xl mb-2">ğŸ–¼ï¸</span><h3 class="text-sm font-black">Ù…Ø¹Ø±Ø¶ ÙƒØ´ÙÙŠ</h3></div>
            <div class="nav-square" onclick="showSection('archive-page')"><span class="text-4xl mb-2">ğŸ“‚</span><h3 class="text-sm font-black">Ø§Ø±Ø´ÙŠÙ Ø§Ù„ÙƒØ´Ø§ÙØ©</h3></div>
            <div class="nav-square" onclick="showSection('quotes-page')"><span class="text-4xl mb-2">ğŸ“œ</span><h3 class="text-sm font-black">Ø§Ù‚ÙˆØ§Ù„ Ø§Ù„Ø§Ù…Ø§Ù… Ø¹Ù„ÙŠ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…</h3></div>
        </div>
        <div class="text-center py-10 px-4 border-t-2 border-gold mt-6 bg-white">
            <h3 style="color:var(--gold)" class="text-2xl font-black italic">Ù†Ø¨Ø§Ø±Ùƒ Ù„ÙƒÙ… ÙˆÙ„Ø§Ø¯Ø© Ø£Ù…ÙŠØ± Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ† ÙˆÙˆØµÙŠ Ø±Ø³ÙˆÙ„ Ø±Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠÙ† Ø§Ù„Ø§Ù…Ø§Ù… Ø¹Ù„ÙŠ (Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…)</h3>
        </div>
    </div>

    <div id="quiz-page" class="full-page">
        <div class="text-right mb-4"><button onclick="hideSection('quiz-page')" class="bg-red-600 text-white px-4 py-1 rounded-lg">âœ– Ø§Ù†Ø³Ø­Ø§Ø¨</button></div>
        <div id="quiz-init" class="text-center">
            <h2 class="text-gold text-3xl mb-6 font-black font-['Amiri']">Ù…Ø³Ø§Ø¨Ù‚Ø© ÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒØ¹Ø¨Ø©</h2>
            <input type="text" id="p-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù„Ù‚Ø¨" class="w-full max-w-xs p-3 border-2 border-gold rounded-xl mb-4 text-center font-bold">
            <button onclick="startChallenge()" class="bg-gradient-to-r from-yellow-600 to-yellow-400 text-white px-10 py-3 rounded-full font-bold text-xl shadow-lg">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡</button>
        </div>
        <div id="quiz-main" class="hidden max-w-md mx-auto bg-white p-6 rounded-2xl border-4 border-gold text-center">
            <div class="mb-4 text-sm font-bold text-gray-500">Ø³Ø¤Ø§Ù„ <span id="q-num">1</span> Ù…Ù† <span id="q-total">0</span></div>
            <h3 id="q-display" class="text-xl font-bold mb-6 text-slate-800"></h3>
            <div id="opts-display"></div>
        </div>
        <div id="cert-box">
            <h2 style="font-family: 'Amiri', serif; color: #8b6b23; font-size: 1.4rem; margin-bottom: 5px;">Ù…ÙƒØªØ¨ Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ø´Ù‡ÙŠØ¯ Ø§Ù„ØµØ¯Ø± (Ù‚Ø¯Ø³ Ø³Ø±Ù‡)</h2>
            <p style="font-size: 0.9rem; margin-bottom: 10px; border-bottom: 1px dashed #D4AF37; padding-bottom: 5px;">ÙƒØ´Ø§ÙØ© Ø§Ù„Ø¨Ù†ÙŠØ§Ù† Ø§Ù„Ù…Ø±ØµÙˆØµ| Ø°ÙŠ Ù‚Ø§Ø±</p>
            <p style="font-size: 0.9rem;">ØªØªÙ‚Ø¯Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ´Ø§ÙØ© Ø¨Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ù„Ù„ÙƒØ´Ø§Ù Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ:</p>
            <h3 id="cert-name" style="color:var(--gold); font-size: 2.5rem;" class="font-['Amiri'] font-black my-4"></h3>
            <p style="font-size: 0.9rem; line-height: 1.5;">Ù„Ø§Ø¬ØªÙŠØ§Ø²Ù‡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙƒØ´ÙÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¨Ø¯Ø±Ø¬Ø© ÙƒØ§Ù…Ù„Ø©ØŒ Ù…ØªÙ…Ù†ÙŠÙ† Ù„Ù‡ Ø¯ÙˆØ§Ù… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø°Ù‡Ø¨ ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹.</p>
            <div class="flex justify-around mt-8 font-bold text-xs text-gray-600"><span> </span><span> </span></div>
            <button onclick="location.reload()" class="mt-8 text-gray-400 text-xs underline"></button>
        </div>
    </div>

    <div id="gallery-page" class="full-page">
        <button onclick="hideSection('gallery-page')" class="bg-gold text-white px-6 py-2 rounded-lg mb-4">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <div id="gal-grid" class="columns-2 gap-2"></div>
    </div>

    <div id="archive-page" class="full-page">
        <div class="flex justify-between mb-4">
            <button onclick="hideSection('archive-page')" class="bg-gold text-white px-6 py-2 rounded-lg">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
            <button onclick="adminLogin()" class="text-[8px] text-gray-300">ADMIN</button>
        </div>
        <div id="admin-panel" class="hidden bg-yellow-50 p-4 rounded-xl border-2 border-gold mb-6">
            <input type="text" id="q-in" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„" class="w-full p-2 mb-2 border">
            <div class="grid grid-cols-3 gap-1 mb-2">
                <input type="text" id="o1" placeholder="Ø®ÙŠØ§Ø±1" class="p-2 border rounded"><input type="text" id="o2" placeholder="Ø®ÙŠØ§Ø±2" class="p-2 border rounded"><input type="text" id="o3" placeholder="Ø®ÙŠØ§Ø±3" class="p-2 border rounded">
            </div>
            <select id="c-in" class="w-full p-2 mb-2 border rounded"><option value="0">1</option><option value="1">2</option><option value="2">3</option></select>
            <button onclick="addQ()" class="w-full bg-blue-600 text-white p-2 mb-2 rounded font-bold">Ù†Ø´Ø± Ø§Ù„Ø³Ø¤Ø§Ù„</button>
            <hr class="my-3">
            <input type="text" id="archive-img-name" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙˆØ±Ø© (101.jpg)" class="w-full p-2 border mb-2">
            <button onclick="addToArchive()" class="w-full bg-green-600 text-white p-2 rounded font-bold text-sm">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø£Ø±Ø´ÙŠÙ</button>
            <div id="admin-q-list" class="mt-4 max-h-40 overflow-y-auto border-t pt-2"></div>
        </div>
        <div id="archive-grid" class="columns-2 gap-2"></div>
    </div>

    <div id="quotes-page" class="full-page">
        <button onclick="hideSection('quotes-page')" class="bg-gold text-white px-6 py-2 rounded-lg mb-4">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <div id="quotes-list" class="space-y-3"></div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyCajxAScOpEbQShZ-8JNcqmrf6gFz8ncnE", authDomain: "mall-bet-madmoom.firebaseapp.com", projectId: "mall-bet-madmoom", appId: "1:922712350704:web:9751ad2419f915a9a74735" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function triggerWarp() {
            document.getElementById('scout-shirt').classList.add('evaporate');
            setTimeout(() => {
                document.getElementById('gate-keeper').style.display = 'none';
                document.getElementById('main-ui').classList.remove('hidden');
                loadGal(); loadQuotes(); fetchQs(); loadArchive();
            }, 1200);
        }

        let questions = [], cur = 0, score = 0;
        async function fetchQs() { const snap = await db.collection("final_v9").orderBy("date").get(); questions = snap.docs.map(doc => doc.data()); }
        
        function startChallenge() {
            let n = document.getElementById('p-name').value;
            if(n.trim().split(/\s+/).length < 3) return alert("Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù„Ù‚Ø¨!");
            document.getElementById('quiz-init').classList.add('hidden');
            document.getElementById('quiz-main').classList.remove('hidden');
            showQ();
        }

       function showQ() {
            const q = questions[cur];
            document.getElementById('q-num').innerText = cur + 1;
            document.getElementById('q-total').innerText = questions.length;
            document.getElementById('q-display').innerText = q.q;
            const b = document.getElementById('opts-display'); 
            b.innerHTML = ""; // ØªØµÙÙŠØ± Ø§Ù„Ø­Ø§ÙˆÙŠØ©
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¹Ù…ÙˆØ¯ÙŠ ÙˆØ£Ù†ÙŠÙ‚
            q.options.forEach((o, i) => {
                const btn = document.createElement('button'); 
                // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ø§Ø³Ø§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©
                btn.className = "w-full p-4 mb-3 border-2 border-gold rounded-xl font-bold transition-all active:scale-95 shadow-sm bg-white text-slate-700 hover:bg-yellow-50"; 
                btn.innerText = o;
                
                btn.onclick = () => {
                    const all = b.querySelectorAll('button');
                    if(i === q.correct) { 
                        btn.style.background = "#2ecc71"; 
                        btn.style.color = "white"; 
                        btn.style.borderColor = "#27ae60";
                        score++; 
                    } else { 
                        btn.style.background = "#e74c3c"; 
                        btn.style.color = "white"; 
                        btn.style.borderColor = "#c0392b";
                        all[q.correct].style.background = "#2ecc71"; 
                        all[q.correct].style.color = "white";
                        all[q.correct].style.borderColor = "#27ae60";
                    }
                    all.forEach(bt => bt.disabled = true);
                    setTimeout(() => { cur++; if(cur < questions.length) showQ(); else finish(); }, 1200);
                };
                b.appendChild(btn);
            });
        }

        function finish() {
            document.getElementById('quiz-main').classList.add('hidden');
            let full = document.getElementById('p-name').value.trim().split(/\s+/);
            // Ù…Ù†Ø·Ù‚ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ ÙˆØ§Ù„Ù„Ù‚Ø¨
            let finalDisp = full[0] + " " + full[full.length - 1];
            document.getElementById('cert-name').innerText = finalDisp;
            document.getElementById('cert-box').style.display = 'block';
        }

        function showSection(id) { document.getElementById(id).style.display = 'flex'; history.pushState({s:id}, ""); }
        function hideSection(id) { document.getElementById(id).style.display = 'none'; }
        window.onpopstate = () => { document.querySelectorAll('.full-page').forEach(p=>p.style.display='none'); };

        function adminLogin() { if(prompt("Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === "asd.alrahe2001") { document.getElementById('admin-panel').classList.toggle('hidden'); renderAList(); } }
        async function addQ() {
            const q = document.getElementById('q-in').value, opts = [document.getElementById('o1').value, document.getElementById('o2').value, document.getElementById('o3').value], correct = parseInt(document.getElementById('c-in').value);
            if(q && opts[2]) { await db.collection("final_v9").add({ q, options: opts, correct, date: new Date() }); alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±"); renderAList(); fetchQs(); }
        }
        async function renderAList() {
            const snap = await db.collection("final_v9").orderBy("date").get();
            const l = document.getElementById('admin-q-list'); l.innerHTML = "";
            snap.forEach(doc => l.innerHTML += `<div class='flex justify-between p-2 border-b text-xs'><span>${doc.data().q}</span><button onclick="delQ('${doc.id}')" class='text-red-500 font-bold'>Ø­Ø°Ù</button></div>`);
        }
        async function delQ(id) { await db.collection("final_v9").doc(id).delete(); renderAList(); }

        async function addToArchive() {
            const img = document.getElementById('archive-img-name').value;
            if(img) { await db.collection("archive_photos").add({ url: img, date: new Date() }); alert("ØªÙ… Ù„Ù„Ø£Ø±Ø´ÙŠÙ"); loadArchive(); }
        }
        async function loadArchive() {
            const snap = await db.collection("archive_photos").orderBy("date", "desc").get();
            document.getElementById('archive-grid').innerHTML = snap.docs.map(doc => `<img src="gallery/${doc.data().url}" class="w-full rounded-lg mb-2 border border-gold shadow-sm">`).join('');
        }
        function loadQuotes() {
            const h = ["Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù ØµÙÙ†Ù’ÙÙØ§Ù†Ù: Ø¥ÙÙ…ÙÙ‘Ø§ Ø£ÙØ®ÙŒ Ù„ÙÙƒÙ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†ÙØŒ Ø£ÙÙˆÙ’ Ù†ÙØ¸ÙÙŠØ±ÙŒ Ù„ÙÙƒÙ ÙÙÙŠ Ø§Ù„Ù’Ø®ÙÙ„Ù’Ù‚Ù.","Ù‚ÙÙŠÙ…ÙØ©Ù ÙƒÙÙ„ÙÙ‘ Ø§Ù…Ù’Ø±ÙØ¦Ù Ù…ÙØ§ ÙŠÙØ­Ù’Ø³ÙÙ†ÙÙ‡Ù.","Ø§Ù„Ù’Ø¹ÙÙ„Ù’Ù…Ù Ø®ÙÙŠÙ’Ø±ÙŒ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ§Ù„Ù.","Ù„Ø§ ØºÙÙ†ÙÙ‰ ÙƒÙØ§Ù„Ù’Ø¹ÙÙ‚Ù’Ù„ÙØŒ ÙˆÙÙ„Ø§ ÙÙÙ‚Ù’Ø±Ù ÙƒÙØ§Ù„Ù’Ø¬ÙÙ‡Ù’Ù„Ù."];
            document.getElementById('quotes-list').innerHTML = h.map(q => `<div class="p-4 bg-white border-r-4 border-gold shadow-sm font-['Amiri']">${q}</div>`).join('');
        }
        function loadGal() { 
            const g = document.getElementById('gal-grid'); g.innerHTML = "";
            for(let i=1; i<=15; i++) g.innerHTML += `<img src="gallery/${i}.jpg" onerror="this.style.display='none'" class="w-full rounded-lg mb-2 border border-gold shadow-sm">`; 
        }
    </script>
</body>
</html>

